{"version":3,"sources":["example.cljs"],"mappings":";AAMA,gBAAA,wBAAAA,xCAAMI;AAAN,AAAA,IAAAH,aAAAD;IAAAC,iBAAA,AAAAC,4BAAAD;gBAAAA,ZAAyCM;cAAzC,AAAAJ,4CAAAF,eAAA,rEAAqBI;aAArB,AAAAF,4CAAAF,eAAA,pEAA6BK;AAA7B,AACE,oBAAMC;AAAN,AAAA,0FAAA,mDAAA,2CAAA,uDAAA,2CAAA,8DAAA,QAAA,oDAAA,OAAA,uDAAA,KAAA,mEAAA,KAAA,gEAAA,MAAA,iEAAA,MAAA,gEAAA,yDAAA,8EAAA,2CAAA,uDAAA,2CAAA,+DAAA,mCAAA,kFAAA,2CAAA,uDAAA,2CAAA,0DAAA,IAAA,+DAAA,2CAAA,mFAAA,mDAAA,mFAAA,yDAAA,2CAAA,gDAAA,2CAAA,8EAAA,iBAAA,mFAAA,3HAgB0BD,8KAEhBD;;AAlBV;;;AAoBF,yBAAA,zBAAMG;AAAN,AACE,IAAMC,QAAM,AAAMC;IACZC,SAAO,SAAA,RAAGF;AADhB,AAEE;AAAA,AACE,GAAM,CAAG,AAAMC,aAASC;AAAxB,AACE;;AADF;;;;;AAGN,eAAA,fAAMC,sCAAMC;AAAZ,AACE,WAAA,AAAAC,PAAMC,uBAAMF;AAAZ,AAAA,0FAAA,mDAEG,AAACT,cAAM,AAAA,qFAAQW,OACf,AAACC,4CAAI,WAAKC;AAAL,AAAA,0FAAA,0DAAA,LAAkBA;oHAH1B,mFAAA,wDAAA,mFAAA,yDAAA,2CAAA,gDAAA,2CAAA,uDAAA,mFAAA,mFAAA,uEAAA,mFAAA,+DAAA,aAAA,mFAAA,uEAAA,mFAAA,+DAAA,2CAAA,yDAAA,SAAA,yDAAA,mFAAA,mFAAA,uEAAA,mFAAA,+DAAA,6DAAA,mBAAA,mFAAA,r8DAGG,mFAAA,OAAA,KAAA,y5DAOC,4CAAKF;;AAEX,AAAKG,gBAAM,6CAAA,7CAACC;AAEZ,iBAAA,jBAAMC;AAAN,AACE,OAACC,qBAAS,wBAAA,xBAACC,+BACD,AAACV,aAAKM;;AAElB,AAACK,+CAA4B,WAAKV;AAAL,AAAA,OAAAC,gBAAaD;;AAE1C,AAACW,wEAA0BC;AAE3B,2BAAA,2CAAA,kDAAA,6EAAA,rMAAKC,yQAGF,WAAAC;AAAA,AAAA,IAAAC,aAAAD;IAAAC,iBAAA,AAAA1B,4BAAA0B;UAAAA,NAAgCG;aAAhC,AAAA5B,4CAAAyB,eAAA,pEAAaC;aAAb,AAAA1B,4CAAAyB,eAAA,pEAAoBE;AAApB,AACE,GAAM,AAACE,cAAIF;AAAX,AACE,yGAAA,2JAAA,pQAACG,+IAAoC,AAACC,wGAAOL;;AAC7C,AAACM,iDAAcL;;AAFjB;;AAGAC;;AAEL,AAACP,wEAA0BE;AAE3B,qCAAA,rCAACU,4GAAqC,WAAKC,EAAExB,MAAMyB,KAAKC;AAAlB,AAAuB,OAACC,mDAAM3B,MAAM4B,mBAASH,KAAKC;;AAExF,qBAAA,rBAAMG,kDAAO7B;AAAb,AACE,iCAAA,WAAA8B,iBAAAC,7DAACC;AAAD,AAAkB,qCAAAF,iBAAAC,/CAACE,wBAAajC;;;AAChC,0BAAA,0DAAA,pFAACkC,oBAAUlC;AAAX,AAA0B,OAACO;;;AAC3B,OAACA;;AAEH,AAACsB,mBAAMxB","names":["p__30037","map__30038","cljs.core/--destructure-map","cljs.core.get","example/alert","content","remove","alert","example/busy-wait-10ms","start","js/Date","target","example/page","store","cljs.core/deref","data","cljs.core.map","text","example/store","cljs.core.atom","example/render","replicant.dom/render","js/document.getElementById","nexus.registry/register-system->state!","nexus.registry.register_interceptor_BANG_","nexus.strategies/fail-fast","example/exception-logger","p__30039","map__30040","effect","errors","ctx","cljs.core/seq","cljs.core.println","cljs.core.pr_str","cljs.pprint.pprint","nexus.registry/register-effect!","_","path","val","cljs.core.swap_BANG_","cljs.core/assoc-in","example/init!","p1__30041#","p2__30042#","replicant.dom/set-dispatch!","nexus.registry/dispatch","cljs.core/add-watch"],"sourcesContent":["(ns example\n  (:require [clojure.pprint :as pprint]\n            [nexus.registry :as nxr]\n            [nexus.strategies :as strategies]\n            [replicant.dom :as r]))\n\n(defn alert [{:keys [content remove] :as alert}]\n  (when alert\n    [:div\n     {:style {:position    \"fixed\"\n              :top         \"5rem\"\n              :right       \"5%\"\n              :margin-left \"5%\"\n              :max-width   \"45%\"\n              :max-height  \"45%\"\n              :transition  \"opacity 0.5s ease-out, transform 0.3s ease-out\"}\n\n      :replicant/mounting\n      {:style {:transform \"translateX(100%)\"}}\n      :replicant/unmounting\n      {:style {:opacity   0\n               :transform \"translateX(100%)\"}}}\n     [:div\n      [:button {:on {:click remove}}\n       \"Remove\"]\n      [:div content]]]))\n\n(defn busy-wait-10ms []\n  (let [start (.now js/Date)\n        target (+ start 10)]\n    (loop []\n      (when (< (.now js/Date) target)\n        (recur)))))\n\n(defn page [store]\n  (let [data @store]\n    [:div\n     (alert (:alert data))\n     (map (fn [text] [:span text \" \"]) [\"list\" \"of\" \"things\"])\n     [:br]\n     [:button {:on {:click [[:state/assoc-in [:alert] nil]\n                            [:state/assoc-in [:alert] {:content \"Alert!\"\n                                                       :remove  [[:state/assoc-in [:alert] nil]]}]]}}\n      \"Click me\"]\n     [:pre\n      (str data)]]))\n\n(def store (atom {}))\n\n(defn render []\n  (r/render (js/document.getElementById \"app\")\n            (page store)))\n\n(nxr/register-system->state! (fn [store] @store))\n\n(nxr/register-interceptor! strategies/fail-fast)\n\n(def exception-logger\n  {:id :exception-logger\n   :after-effect\n   (fn [{:keys [effect errors] :as ctx}]\n     (when (seq errors)\n       (println \"\u26a0\ufe0f  Errors while handling\" (pr-str effect) \":\")\n       (pprint/pprint errors))\n     ctx)})\n\n(nxr/register-interceptor! exception-logger)\n\n(nxr/register-effect! :state/assoc-in (fn [_ store path val] (swap! store assoc-in path val)))\n\n(defn init! [store]\n  (r/set-dispatch! #(nxr/dispatch store %1 %2))\n  (add-watch store :render #(render))\n  (render))\n\n(init! store)\n\n\n"]}